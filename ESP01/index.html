<!doctype html><html lang=es class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Repositorio dedicado al tema de prueba de todo tipo de cosas relacionadas con las placas tipo Arduino fundamentalmente de Keyestudio en sus distintas versiones."><meta name=author content="Federico Coca"><link href=https://fgcoca.github.io/Sensores-actuadores-y-shield-tipo-Arduino/ESP01/ rel=canonical><link rel=icon href=../img/favicon.png><meta name=generator content="mkdocs-1.2.3, mkdocs-material-8.1.11"><title>Modulo ESP8266 ESP 01, shield de programación y dirección MAC - Sensores actuadores y shield tipo Arduino</title><link rel=stylesheet href=../assets/stylesheets/main.50e68009.min.css><link rel=stylesheet href=../assets/stylesheets/palette.e6a45f82.min.css><meta name=theme-color content=#02a6f2><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme data-md-color-primary=light-blue data-md-color-accent=deep-purple> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#modulo-esp8266-esp-01-shield-de-programacion-y-direccion-mac class=md-skip> Saltar a contenido </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Cabecera> <a href=.. title="Sensores actuadores y shield tipo Arduino" class="md-header__button md-logo" aria-label="Sensores actuadores y shield tipo Arduino" data-md-component=logo> <img src=../img/favicon.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Sensores actuadores y shield tipo Arduino </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Modulo ESP8266 ESP 01, shield de programación y dirección MAC </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Búsqueda placeholder=Búsqueda autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" aria-label=Limpiar tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Inicializando búsqueda </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/fgcoca/Sensores-actuadores-y-shield-tipo-Arduino title="Ir al repositorio" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> Sensores-actuadores-y-shield-tipo-Arduino </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navegación data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title="Sensores actuadores y shield tipo Arduino" class="md-nav__button md-logo" aria-label="Sensores actuadores y shield tipo Arduino" data-md-component=logo> <img src=../img/favicon.png alt=logo> </a> Sensores actuadores y shield tipo Arduino </label> <div class=md-nav__source> <a href=https://github.com/fgcoca/Sensores-actuadores-y-shield-tipo-Arduino title="Ir al repositorio" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> Sensores-actuadores-y-shield-tipo-Arduino </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> Introducción </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2> Introducción a ArduinoBlocks <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Introducción a ArduinoBlocks" data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Introducción a ArduinoBlocks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../crear-cuenta-gmail/ class=md-nav__link> Crear cuenta en Gmail </a> </li> <li class=md-nav__item> <a href=../crear-cuenta-AB/ class=md-nav__link> Crear cuenta en ArduinoBlocks </a> </li> <li class=md-nav__item> <a href=../primeros-AB/ class=md-nav__link> Primeros pasos con AB </a> </li> <li class=md-nav__item> <a href=../plataformaAB/ class=md-nav__link> Plataforma AB </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../turbidez/ class=md-nav__link> Sensor de turbidez </a> </li> <li class=md-nav__item> <a href=../ccs811/ class=md-nav__link> Sensor CCS811 de eCO2, TVOC y temperatura </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Modulo ESP8266 ESP 01, shield de programación y dirección MAC <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Modulo ESP8266 ESP 01, shield de programación y dirección MAC </a> <nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Tabla de contenidos </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#modulo-esp8266-esp-01 class=md-nav__link> Módulo ESP8266 ESP 01 </a> <nav class=md-nav aria-label="Módulo ESP8266 ESP 01"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#introduccion class=md-nav__link> Introducción </a> </li> <li class=md-nav__item> <a href=#caracteristicas class=md-nav__link> Características </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#programacion-del-modulo-esp8266-esp-01 class=md-nav__link> Programación del módulo ESP8266 ESP 01 </a> <nav class=md-nav aria-label="Programación del módulo ESP8266 ESP 01"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#comando-at-en-el-esp8266 class=md-nav__link> Comando AT en el ESP8266 </a> </li> <li class=md-nav__item> <a href=#preparacion-del-modulo-esp-01 class=md-nav__link> Preparación del módulo ESP-01 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#obtener-la-direccion-mac-del-esp-01 class=md-nav__link> Obtener la dirección MAC del ESP-01 </a> <nav class=md-nav aria-label="Obtener la dirección MAC del ESP-01"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#introduccion_1 class=md-nav__link> Introducción </a> </li> <li class=md-nav__item> <a href=#firmware class=md-nav__link> Firmware </a> </li> <li class=md-nav__item> <a href=#conexionado class=md-nav__link> Conexionado </a> </li> <li class=md-nav__item> <a href=#comunicacion-entre-pc-y-esp01 class=md-nav__link> Comunicación entre PC y ESP01 </a> </li> <li class=md-nav__item> <a href=#direccion-mac class=md-nav__link> Dirección MAC </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../panel-easy-plug/ class=md-nav__link> Panel de sensores Easy Plug </a> </li> <li class=md-nav__item> <a href=../panel-I2C/ class=md-nav__link> Panel de sensores I2C </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_8 type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8> Miscelanea <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Miscelanea data-md-level=1> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Miscelanea </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Miscelanea/about/ class=md-nav__link> Autor </a> </li> <li class=md-nav__item> <a href=../Miscelanea/lic/ class=md-nav__link> Licencias </a> </li> <li class=md-nav__item> <a href=../Miscelanea/webgrafia/ class=md-nav__link> Webgrafia/Bibliografía </a> </li> <li class=md-nav__item> <a href=../Miscelanea/soft/ class=md-nav__link> Software utilizado </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Tabla de contenidos </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#modulo-esp8266-esp-01 class=md-nav__link> Módulo ESP8266 ESP 01 </a> <nav class=md-nav aria-label="Módulo ESP8266 ESP 01"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#introduccion class=md-nav__link> Introducción </a> </li> <li class=md-nav__item> <a href=#caracteristicas class=md-nav__link> Características </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#programacion-del-modulo-esp8266-esp-01 class=md-nav__link> Programación del módulo ESP8266 ESP 01 </a> <nav class=md-nav aria-label="Programación del módulo ESP8266 ESP 01"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#comando-at-en-el-esp8266 class=md-nav__link> Comando AT en el ESP8266 </a> </li> <li class=md-nav__item> <a href=#preparacion-del-modulo-esp-01 class=md-nav__link> Preparación del módulo ESP-01 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#obtener-la-direccion-mac-del-esp-01 class=md-nav__link> Obtener la dirección MAC del ESP-01 </a> <nav class=md-nav aria-label="Obtener la dirección MAC del ESP-01"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#introduccion_1 class=md-nav__link> Introducción </a> </li> <li class=md-nav__item> <a href=#firmware class=md-nav__link> Firmware </a> </li> <li class=md-nav__item> <a href=#conexionado class=md-nav__link> Conexionado </a> </li> <li class=md-nav__item> <a href=#comunicacion-entre-pc-y-esp01 class=md-nav__link> Comunicación entre PC y ESP01 </a> </li> <li class=md-nav__item> <a href=#direccion-mac class=md-nav__link> Dirección MAC </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=modulo-esp8266-esp-01-shield-de-programacion-y-direccion-mac><font color=#8B008B>Modulo ESP8266 ESP 01, shield de programación y dirección MAC</font><a class=headerlink href=#modulo-esp8266-esp-01-shield-de-programacion-y-direccion-mac title="Permanent link">&para;</a></h1> <h2 id=modulo-esp8266-esp-01><font color=#007575>Módulo ESP8266 ESP 01</font><a class=headerlink href=#modulo-esp8266-esp-01 title="Permanent link">&para;</a></h2> <h3 id=introduccion><font color=#AA0000>Introducción</font><a class=headerlink href=#introduccion title="Permanent link">&para;</a></h3> <p>El módulo Wifi seleccionado (ESP-01) es uno de las más populares y económicos, pese a no ser el más potente ni versátil. Actualmente, otros modelos como la ESP-12 se están integrando en la mayoría de placas de desarrollo, cobrando un peso e importancia mucho mayor. Sin embargo, nosotros vamos a asociar nuestro pequeño ESP-01 a un Arduino UNO, con el único fin de darle conectividad Wifi. Es este motivo por el que se ha considerado este modelo concreto el idóneo para llevar a cabo el proyecto aquí expuesto, ya que no necesitamos más pines extra, ni otro tipo de ventajas que incluyen modelos superiores.</p> <p>El ESP-01 trae instalado una versión de firmware con la que podemos comunicarnos con el ESP8266 mediante comandos AT (los veremos a continuación) a través del puerto serie. Este tipo de comunicación nos va a permitir crear un puente entre la placa de control del proyecto y el ESP8266, consiguiendo así conectar a una red WIFI y dar un primer paso de gigantes en el mundo IoT.</p> <h3 id=caracteristicas><font color=#AA0000>Características</font><a class=headerlink href=#caracteristicas title="Permanent link">&para;</a></h3> <p>El aspecto del ESP-01 y algunas de sus características los vemos a continuación.</p> <p><center></p> <table> <thead> <tr> <th align=center>Aspecto del ESP-01</th> </tr> </thead> <tbody> <tr> <td align=center><img alt="Aspecto del ESP-01" src=../img/ESP8266_ESP01/aspecto.png></td> </tr> </tbody> </table> <p></center></p> <p>ESP8266 es el microcontrolador del módulo ESP-01. La memoria flash es la BG25Q80A. Los LEDs informan de si está encendido o no y de la transmisión de datos (Tx y Rx). La antena WiFi para la conexión a internet está diseñada en la placa. Los pines permiten conectar alimentación, sensores, … Toda la información en el <a href=https://www.microchip.ua/wireless/esp01.pdf>datasheet</a> del fabricante.</p> <p>A continuación vemos la imagen con la distribución de pines y su significado:</p> <p><center></p> <table> <thead> <tr> <th align=center>Distribución de pines en el ESP-01</th> </tr> </thead> <tbody> <tr> <td align=center><img alt="Distribución de pines en el ESP-01" src=../img/ESP8266_ESP01/pines.png></td> </tr> </tbody> </table> <p></center></p> <ul> <li>1 - GND</li> <li>2 - Pin digital número 2</li> <li>3 - Pin digital número 0</li> <li>4 - RXD es el pin por donde se van a recibir los datos del puerto serie. Trabaja a 3,3 V. También puede ser el pin digital GPIO3</li> <li>5 - TXD es el pin por donde se van a transmitir los datos del puerto serie. Trabaja a 3,3 V. También puede ser el pin digital GPIO1</li> <li>6 - CH_PD es el pin para apagar y encender el ESP-01: si lo ponemos a 0 V (LOW) se apaga, y a 3,3 V (HIGH) se enciende.</li> <li>7 - RESET pin a 0V resetea el ESP-01</li> <li>Vcc es el pin de alimentación. Funciona a 3,3V y admite un máximo de 3,6 V. La corriente suministrada debe ser mayor que 200 mA.</li> </ul> <p>Datos obtenidos de <a href=https://programarfacil.com/ >programarfacil</a>.</p> <p>*GPIO (del inglés, General Purpose Input Output) son entradas o salidas de propósito general, o sea pines digitales.</p> <p>El ESP-01 soporta comunicación I2C, por lo que, pese a tener solo un par de GPIOs, podemos conectarle multitud de sensores y actuadores a través del mencionado bus de datos I2C.*</p> <h2 id=programacion-del-modulo-esp8266-esp-01><font color=#007575>Programación del módulo ESP8266 ESP 01</font><a class=headerlink href=#programacion-del-modulo-esp8266-esp-01 title="Permanent link">&para;</a></h2> <p>El ESP-01 dispone de un microcontrolador y una memoria donde poder almacenar programas, luego es un dispositivo programable en si mismo. Cargar programas en el dispositivo es algo mas complejo de lo que normalmente estamos acostumbrados dado que tiene dos modos de operación, el modo flash o de ejecución y el modo UART o de grabación y debemos ser nosotros quienes activemos un modo u otro, cosa que, por ejemplo, en el entorno ArduinoBlocks el mismo ha sido el encargado de hacerlo. Los modos de operación se configuran a través de los puertos GPIO0 y GPIO2.</p> <p>Para programar el ESP-01 hay que usar los pines Rx y Tx para transmitir los datos a la memoria Flash, donde se almacenará el sketch o programa.</p> <p>En las placas de control los pines Rx y Tx están en los pines D0 y D1 respectivamente y también son los que se utilizan para cargar programas a una velocidad de 115200 baudios, así que si estos pines los ocupamos con el ESP8266 no podremos cargar programas en nuestra placa. Ahora bien, es posible utilizar otros pines para usar WiFi y evitar este problema, pero el resto de pines digitales solamente trabajan a 9600 baudios y el ESP-01 por defecto viene a 115200, luego para utilizarlo en pines distintos a los D0 y D1 de la placa tendremos que reprogramarlo para que la velocidad sea de 9600 baudios.</p> <ul> <li> <p><strong>Modo de funcionamiento UART</strong>. Para cargar un programa en el ESP-01 debemos o bien encenderlo o bien resetearlo pero teniendo los siguientes estados de pines:</p> </li> <li> <p>GPIO0 = 0 (nivel bajo o LOW = 0 V)</p> </li> <li>GPIO2 = 1 (nivel alto o HIGH = 3,3 V = Vcc).</li> </ul> <p>Recordemos siempre que el ESP8266 trabaja con niveles lógicos de 3,3 V.</p> <p>El pin GPIO2 está por defecto a HIGH, ya que tiene un pull-up interno, por lo que podemos dejarlo simplemente desconectado.</p> <ul> <li> <p><strong>Modo de funcionamiento Flash</strong>. Para ejecutar un programa en el ESP-01 una vez cargado debemos tener la siguiente configuración de pines:</p> </li> <li> <p>GPIO0 = 1</p> </li> <li>GPIO2 = 1</li> </ul> <p>Tanto el GPIO0 como el GPIO2 están por defecto a HIGH, ya que ambos tienen un pull-up interno, por lo que podemos dejarlos simplemente desconectados.</p> <p>En este momento reflexionamos sobre el uso de Rx y Tx ya que si los estamos utilizando para cargar el programa en la placa y GPIO0 y GPIO2 para indicar el modo de trabajo ¿cómo conectamos los sensores y actuadores al ESP-01?. Veamos:</p> <ol> <li>Rx y Tx los utilizamos para cargar el programa. Una vez finalizada la carga los podemos utilizar como pines de entrada y salida digitales.</li> <li>Los modos de trabajo se indican cuando se resetea o reinicia la placa. Una vez que tengamos el modo de ejecución podemos conectar cualquier componente a estos pines.</li> </ol> <p>Los programas los podemos subir a nuestro ESP-01 mediante el IDE de Arduino, que no vamos a explicar aquí, o por medio de un convertidor USB-serie igual o similar al <a href=https://wiki.keyestudio.com/KS0388_Keyestudio_USB_to_ESP-01S_Wifi_Module_Serial_Port_Shield>KS0388 Keyestudio USB to ESP-01S Wifi Module Serial Port Shield</a> de la imagen.</p> <p><center></p> <table> <thead> <tr> <th align=center>Shield para el módulo WiFi ESP-01</th> </tr> </thead> <tbody> <tr> <td align=center><img alt="Shield para el módulo WiFi ESP-01" src=../img/ESP8266_ESP01/adaptador.png></td> </tr> </tbody> </table> <p></center></p> <p>Se trata de un escudo o shield para el módulo WiFi ESP-01 que está provisto de un chip conversor de USB a puerto serie, en concreto el CH340G.</p> <p>El proceso de reprogramación con esta placa es bastante sencillo pero requiere de comando AT que pasamos a introducir antes de continuar.</p> <h3 id=comando-at-en-el-esp8266><font color=#AA0000>Comando AT en el ESP8266</font><a class=headerlink href=#comando-at-en-el-esp8266 title="Permanent link">&para;</a></h3> <p>El ESP-01 viene por defecto con el firmware AT ai-thinker V0.9.2.4.</p> <p>Los módems venían con un conjunto de comandos que permiten que nos podamos comunicar con ellos para configurarlos y que lo podamos hacer a través del puerto serie de ordenador al que están conectados. A estos comandos se les llama AT (de attention).</p> <p>Después de cada comando AT, el ESP8266 espera los caracteres especiales de nueva linea para ejecutar el comando. El carácter no imprimible CR (del inglés, Carriage Return) significa retorno de carro y LF ( del inglés, Line Feed) es salto de línea. El origen de la nomenclatura está en las máquinas de escribir.</p> <p>En el enlace tenemos un pdf de la empresa <a href="https://docs.google.com/viewer?url=https%3A%2F%2Fwww.espressif.com%2Fsites%2Fdefault%2Ffiles%2Fdocumentation%2F4a-esp8266_at_instruction_set_en.pdf">Espressif Systems</a> con el juego de comandos AT para el ESP8266.</p> <h3 id=preparacion-del-modulo-esp-01><font color=#AA0000>Preparación del módulo ESP-01</font><a class=headerlink href=#preparacion-del-modulo-esp-01 title="Permanent link">&para;</a></h3> <p>Primero conectamos el módulo ESP8266 a la shield USB-serie y este a su vez a un puerto USB de nuestro ordenador. Nos aseguramos de que el interruptor está en modo Flash Boot.</p> <p>Entramos en ArduinoBlocks con ArduinoBlocks-Connector en funcionamiento, realizamos un refresco de la lectura del puerto para que detecte a la shield del módulo Wi-fi si es necesario, abrimos la consola, escogeremos la opción de 115200 en baudrate y también la de NL + LF (NL + LF es igual que CR + LF) para comunicarnos con el módulo Wi-fi.</p> <p>Hacemos clic en Conectar y conectamos la consola, escribimos “AT” en ella y clic en enviar. La situación es la de la imagen siguiente:</p> <p><center></p> <table> <thead> <tr> <th align=center>Conexión y configuración de la consola</th> </tr> </thead> <tbody> <tr> <td align=center><img alt="Conexión y configuración de la consola" src=../img/ESP8266_ESP01/configAB.png></td> </tr> </tbody> </table> <p></center></p> <p>Si todo es correcto debe respondernos “OK”. Si responde algo sin sentido o no contesta, significa que está configurado en alguna otra velocidad. En este segundo caso deberemos cambiar la opción de baudrate y repetir la operación con diferentes velocidades hasta que nos responda “OK”. La situación correcta en la consola de comandos es la siguiente:</p> <p><center></p> <table> <thead> <tr> <th align=center>Conexión correcta</th> </tr> </thead> <tbody> <tr> <td align=center><img alt="Conexión correcta" src=../img/ESP8266_ESP01/AT-OK.png></td> </tr> </tbody> </table> <p></center></p> <p>Una vez que nos responda “OK”, le enviamos el texto “AT+UART_DEF=9600,8,1,0,0” y nos debe responder otra vez “OK”.</p> <p><center></p> <table> <thead> <tr> <th align=center>Cambio del baudrate a 9600</th> </tr> </thead> <tbody> <tr> <td align=center><img alt="Cambio del baudrate a 9600" src=../img/ESP8266_ESP01/9600-OK.png></td> </tr> </tbody> </table> <p></center></p> <p>Con esto hemos cambiado la velocidad a 9600 baudios mediante el comando AT+UART_DEF que nos permite cambiar la definición a 9600 baudios, con 8 bits de datos, 1 bit de parada, sin paridad y sin habilitar el control de flujo.</p> <h2 id=obtener-la-direccion-mac-del-esp-01><font color=#007575>Obtener la dirección MAC del ESP-01</font><a class=headerlink href=#obtener-la-direccion-mac-del-esp-01 title="Permanent link">&para;</a></h2> <h3 id=introduccion_1><font color=#AA0000>Introducción</font><a class=headerlink href=#introduccion_1 title="Permanent link">&para;</a></h3> <p>Pretendemos averiguar la dirección fisica o MAC de un dispositivo de conexión WiFi y para ello vamos a seguir unos sencillo pasos, uqe si los ejecutamos en el orden correcto nos darán el resultado esperado.</p> <p>Yo lo voy a hacer sobre una placa Keyestudio UNO, pero el procedimiento puede ser válido para otros modelos de placa.</p> <h3 id=firmware><font color=#AA0000>Firmware</font><a class=headerlink href=#firmware title="Permanent link">&para;</a></h3> <p>Antes de conectar nada a nuestra placa vamos a cargar un programa vacío en el IDE de arduino y grabarlo en la placa Keyestudio UNO.</p> <hr> <div class=highlight><pre><span></span><code>void setup() {
  // put your setup code here, to run once:
}
void loop() {
  // put your main code here, to run repeatedly:
}
</code></pre></div> <hr> <h3 id=conexionado><font color=#AA0000>Conexionado</font><a class=headerlink href=#conexionado title="Permanent link">&para;</a></h3> <p>Ahora procedemos a conectar nuestro ESP8266 ESP01 para poder comunicar nuestro ordenador con el ESP8266. El esquema es el que vemos en la imagen siguiente:</p> <p><center></p> <table> <thead> <tr> <th align=center>Conexionado ESP-01 y UNO</th> </tr> </thead> <tbody> <tr> <td align=center><img alt="Conexionado ESP-01 y UNO" src=../img/ESP8266_ESP01/MAC/conexiones.png></td> </tr> </tbody> </table> <p></center></p> <h3 id=comunicacion-entre-pc-y-esp01><font color=#AA0000>Comunicación entre PC y ESP01</font><a class=headerlink href=#comunicacion-entre-pc-y-esp01 title="Permanent link">&para;</a></h3> <p>Con un programa vacío en nuestra placa Keyestudio UNO y las conexiones descritas en realidad lo que hacemos es usar la placa UNO como un convertidor bidireccional USB a RS232 que nos permite comunicar el ordenador con la placa ESP8266 ESP01. Abrimos el monitor serie desde el IDE de Arduino y lo configuramos como vemos en la imagen siguiente:</p> <p><center></p> <table> <thead> <tr> <th align=center>Configuración inicial</th> </tr> </thead> <tbody> <tr> <td align=center><img alt="Configuración inicial" src=../img/ESP8266_ESP01/MAC/Config-monitor-serie.png></td> </tr> </tbody> </table> <p></center></p> <p>Escribimos AT y pulsamos Enter o clicamos en Enviar y el módulo deberá responder OK si todo es correcto. Si la velocidad por defecto del módulo no es de 115200 no responerá y posiblemente se vean caracteres extraños en el monitor serie. En este caso habrá que probar distintas velocidades hasta conseguir que el módulo responda OK al comando AT. El resultado correcto lo vemos en la imagen siguiente:</p> <p><center></p> <table> <thead> <tr> <th align=center>Conexión correcta</th> </tr> </thead> <tbody> <tr> <td align=center><img alt="Conexión correcta" src=../img/ESP8266_ESP01/MAC/AT-OK.png></td> </tr> </tbody> </table> <p></center></p> <h3 id=direccion-mac><font color=#AA0000>Dirección MAC</font><a class=headerlink href=#direccion-mac title="Permanent link">&para;</a></h3> <p>El último paso es teclear el comando AT para conseguir la dirección física o MAC del dispositivo conectado. Este comando es el que vemos en la imagen siguiente:</p> <p><center></p> <table> <thead> <tr> <th align=center>Comando para obtener la MAC</th> </tr> </thead> <tbody> <tr> <td align=center><img alt="Comando para obtener la MAC" src=../img/ESP8266_ESP01/MAC/comando-AT.png></td> </tr> </tbody> </table> <p></center></p> <p>El comando AT+CIFSR nos devuelve el siguiente resultado:</p> <p><center></p> <table> <thead> <tr> <th align=center>Respuesta al comando comando AT+CIFSR</th> </tr> </thead> <tbody> <tr> <td align=center><img alt="Respuesta al comando comando AT+CIFSR" src=../img/ESP8266_ESP01/MAC/MAC.png></td> </tr> </tbody> </table> <p></center></p> </article> </div> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Pie> <a href=../ccs811/ class="md-footer__link md-footer__link--prev" aria-label="Anterior: Sensor CCS811 de eCO2, TVOC y temperatura" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Anterior </span> Sensor CCS811 de eCO2, TVOC y temperatura </div> </div> </a> <a href=../panel-easy-plug/ class="md-footer__link md-footer__link--next" aria-label="Siguiente: Panel de sensores Easy Plug" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Siguiente </span> Panel de sensores Easy Plug </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2022 - 2032 Federico Coca </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": [], "translations": {"clipboard.copy": "Copiar al portapapeles", "clipboard.copied": "Copiado al portapapeles", "search.config.lang": "es", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "B\u00fasqueda", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.term.missing": "Falta", "select.version.title": "Seleccionar versi\u00f3n"}, "search": "../assets/javascripts/workers/search.092fa1f6.min.js"}</script> <script src=../assets/javascripts/bundle.5a9542cf.min.js></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script> </body> </html>